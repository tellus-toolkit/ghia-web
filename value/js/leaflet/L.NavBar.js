/*
*  Simple navigation control that allows back and forward navigation through map's view history
*/
!function(){L.Control.NavBar=L.Control.extend({options:{position:"topleft",forwardTitle:"Go forward in map view history",backTitle:"Go back in map view history",homeTitle:"Go to home map view"},onAdd:function(t){this.options.center||(this.options.center=t.getCenter()),this.options.zoom||(this.options.zoom=t.getZoom()),options=this.options;var o="leaflet-control-navbar",i=L.DomUtil.create("div",o+" leaflet-bar");return this._homeButton=this._createButton(options.homeTitle,o+"-home",i,this._goHome),this._fwdButton=this._createButton(options.forwardTitle,o+"-fwd",i,this._goFwd),this._backButton=this._createButton(options.backTitle,o+"-back",i,this._goBack),this._viewHistory=[{center:this.options.center,zoom:this.options.zoom}],this._curIndx=0,this._updateDisabled(),t.once("moveend",function(){this._map.on("moveend",this._updateHistory,this)},this),t.setView(options.center,options.zoom),i},onRemove:function(t){t.off("moveend",this._updateHistory,this)},_goHome:function(){this._map.setView(this.options.center,this.options.zoom)},_goBack:function(){if(0!==this._curIndx){this._map.off("moveend",this._updateHistory,this),this._map.once("moveend",function(){this._map.on("moveend",this._updateHistory,this)},this),this._curIndx--,this._updateDisabled();var t=this._viewHistory[this._curIndx];this._map.setView(t.center,t.zoom)}},_goFwd:function(){if(this._curIndx!=this._viewHistory.length-1){this._map.off("moveend",this._updateHistory,this),this._map.once("moveend",function(){this._map.on("moveend",this._updateHistory,this)},this),this._curIndx++,this._updateDisabled();var t=this._viewHistory[this._curIndx];this._map.setView(t.center,t.zoom)}},_createButton:function(t,o,i,e){var s=L.DomUtil.create("a",o,i);return s.href="#",s.title=t,L.DomEvent.on(s,"mousedown dblclick",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.stop).on(s,"click",e,this).on(s,"click",this._refocusOnMap,this),s},_updateHistory:function(){var t={center:this._map.getCenter(),zoom:this._map.getZoom()},o=this._curIndx+1;this._viewHistory.splice(o,this._viewHistory.length-o,t),this._curIndx++,this._updateDisabled()},_setFwdEnabled:function(t){var o="leaflet-disabled",i="leaflet-control-navbar-fwd-disabled";t===!0?(L.DomUtil.removeClass(this._fwdButton,i),L.DomUtil.removeClass(this._fwdButton,o)):(L.DomUtil.addClass(this._fwdButton,i),L.DomUtil.addClass(this._fwdButton,o))},_setBackEnabled:function(t){var o="leaflet-disabled",i="leaflet-control-navbar-back-disabled";t===!0?(L.DomUtil.removeClass(this._backButton,i),L.DomUtil.removeClass(this._backButton,o)):(L.DomUtil.addClass(this._backButton,i),L.DomUtil.addClass(this._backButton,o))},_updateDisabled:function(){this._setFwdEnabled(this._curIndx==this._viewHistory.length-1?!1:!0),this._setBackEnabled(this._curIndx<=0?!1:!0)}}),L.control.navbar=function(t){return new L.Control.NavBar(t)}}();